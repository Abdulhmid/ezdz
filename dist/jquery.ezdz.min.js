 /* ----------------------------------------------------------------------------
 // Ezdz [izy-dizy] jQuery plugin
 // v0.1.0 - released 2013-10-14 00:43
 // Licensed under the MIT license.
 // https://github.com/jaysalvat/ezdz
 // ----------------------------------------------------------------------------
 // Copyright (C) 2013 Jay Salvat
 // http://jaysalvat.com/
 // ---------------------------------------------------------------------------*/

!function(a){var b={className:"",text:"Drop a file",previewImage:!0,value:null,classes:{main:"ezdz-dropzone",enter:"ezdz-enter",reject:"ezdz-reject",accept:"ezdz-accept",focus:"ezdz-focus"},validators:{maxSize:null,width:null,maxWidth:null,minWidth:null,height:null,maxHeight:null,minHeight:null},init:function(){},enter:function(){},leave:function(){},reject:function(){},accept:function(){},format:function(a){return a}};a.ezdz=function(c,d){var e=this,f=a.extend(!0,{},b,a.ezdz.defaults,d),g=a(c);if(!g.is('input[type="file"]'))return a.error("Ezdz error - Must be apply to inputs type file."),void 0;if(window.File&&window.FileList&&window.FileReader){e.preview=function(b,c){var d=b.replace(/\\/g,"/").replace(/.*\//,""),e=f.format(d),h=g.parent("."+f.classes.main),i=new Image;i.src=b,i.onload=function(){h.find("div").html(a(i).fadeIn()),a.isFunction(c)&&c.apply(this)},i.onerror=function(){h.find("div").html("<span>"+e+"</span>"),a.isFunction(c)&&c.apply(this)},h.addClass(f.classes.accept)},e.destroy=function(){g.parent("."+f.classes.main).replaceWith(g),g.off("*.ezdz"),g.data("ezdz","")},e.options=function(b){a.extend(!0,f,b)};var h=function(){var b,c,d;c=a('<div class="'+f.classes.main+'" />').on("dragover.ezdz",function(){a(this).addClass(f.classes.enter),a.isFunction(f.enter)&&f.enter.apply(this)}).on("dragleave.ezdz",function(){a(this).removeClass(f.classes.enter),a.isFunction(f.leaved)&&f.leaved.apply(this)}).addClass(f.className),g.wrap(c).before("<div>"+f.text+"</div>"),b=g.parent("."+f.classes.main),d=f.value||g.data("value"),d&&e.preview(d),a.isFunction(f.init)&&f.init.apply(b,[d]),g.on("focus.ezdz",function(){b.addClass(f.classes.focus)}).on("blur.ezdz",function(){b.removeClass(f.classes.focus)}).on("change.ezdz",function(){var c=this.files[0];if(c){var d=c.name.replace(/\\/g,"/").replace(/.*\//,""),e=c.name.split(".").pop(),h=f.format(d);c.extension=e;var i=g.attr("accept"),j=!1;if(valid=!0,errors={mimeType:!1,maxSize:!1,width:!1,minWidth:!1,maxWidth:!1,height:!1,minHeight:!1,maxHeight:!1},i){var k=i.split(/[,|]/);a.each(k,function(b,d){if(d=a.trim(d),c.type==d)return j=!0,!1;if(d.indexOf("/*")!==!1){var e=d.replace("/*",""),f=c.type.replace(/(\/.*)$/g,"");if(e===f)return j=!0,!1}}),j===!1&&(errors.mimeType=!0)}else j=!0;if(b.removeClass(f.classes.reject+" "+f.classes.accept),j!==!0)return g.val(""),b.addClass(f.classes.reject),a.isFunction(f.reject)&&f.reject.apply(b,[c,errors]),!1;var l=new FileReader(c),m=new Image;l.readAsDataURL(c),l.onload=function(d){c.data=d.target.result,m.src=c.data;var e=m.width&&m.height;f.validators.maxSize&&c.size>f.validators.maxSize&&(valid=!1,errors.maxSize=!0),e&&(c.width=m.width,c.height=m.height,f.validators.width&&m.width!=f.validators.width&&(valid=!1,errors.width=!0),f.validators.maxWidth&&m.width>f.validators.maxWidth&&(valid=!1,errors.maxWidth=!0),f.validators.minWidth&&m.width<f.validators.minWidth&&(valid=!1,errors.minWidth=!0),f.validators.height&&m.height!=f.validators.height&&(valid=!1,errors.height=!0),f.validators.maxHeight&&m.height>f.validators.maxHeight&&(valid=!1,errors.maxHeight=!0),f.validators.minHeight&&m.height<f.validators.minHeight&&(valid=!1,errors.minHeight=!0)),valid===!0?(b.find("img").remove(),e&&f.previewImage===!0?b.find("div").html(a(m).fadeIn()):b.find("div").html("<span>"+h+"</span>"),b.addClass(f.classes.accept),a.isFunction(f.accept)&&f.accept.apply(b,[c])):(g.val(""),b.addClass(f.classes.reject),a.isFunction(f.reject)&&f.reject.apply(b,[c,errors]))}}})};h()}},a.fn.ezdz=function(b){var c=arguments;return this.each(function(){var d=a(this).data("ezdz");return d?d[b]?d[b].apply(this,Array.prototype.slice.call(c,1)):(a.error("Ezdz error - Method "+b+" does not exist."),void 0):a(this).data("ezdz",new a.ezdz(this,b))})},a.ezdz.defaults=b}(jQuery);